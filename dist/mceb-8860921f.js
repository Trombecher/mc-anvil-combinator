var P=Object.defineProperty;var C=(t,i,e)=>i in t?P(t,i,{enumerable:!0,configurable:!0,writable:!0,value:e}):t[i]=e;var u=(t,i,e)=>(C(t,typeof i!="symbol"?i+"":i,e),e);const M=[{name:"Protection",id:"A",maxLevel:4,applicable:["Helmet","Chestplate","Leggings","Boots"],itemMultiplier:1,bookMultiplier:1,incompatible:["Fire Protection","Blast Protection","Projectile Protection"]},{name:"Fire Protection",id:"B",maxLevel:4,applicable:["Helmet","Chestplate","Leggings","Boots"],itemMultiplier:2,bookMultiplier:1,incompatible:["Protection","Blast Protection","Projectile Protection"]},{name:"Feather Falling",id:"C",maxLevel:4,applicable:["Boots"],itemMultiplier:2,bookMultiplier:1,incompatible:[]},{name:"Blast Protection",id:"D",maxLevel:4,applicable:["Helmet","Chestplate","Leggings","Boots"],itemMultiplier:4,bookMultiplier:2,incompatible:["Protection","Fire Protection","Projectile Protection"]},{name:"Projectile Protection",id:"E",maxLevel:4,applicable:["Helmet","Chestplate","Leggings","Boots"],itemMultiplier:2,bookMultiplier:1,incompatible:["Protection","Fire Protection","Blast Protection"]},{name:"Thorns",id:"F",maxLevel:3,applicable:["Helmet","Chestplate","Leggings","Boots"],itemMultiplier:8,bookMultiplier:4,incompatible:[]},{name:"Respiration",id:"G",maxLevel:3,applicable:["Helmet"],itemMultiplier:4,bookMultiplier:2,incompatible:[]},{name:"Depth Strider",id:"H",maxLevel:3,applicable:["Boots"],itemMultiplier:4,bookMultiplier:2,incompatible:["Frost Walker"]},{name:"Aqua Affinity",id:"I",maxLevel:1,applicable:["Helmet"],itemMultiplier:4,bookMultiplier:2,incompatible:[]},{name:"Sharpness",id:"J",maxLevel:5,applicable:["Sword","Axe"],itemMultiplier:1,bookMultiplier:1,incompatible:["Smite","Bane of Arthropods"]},{name:"Smite",id:"K",maxLevel:5,applicable:["Sword","Axe"],itemMultiplier:2,bookMultiplier:1,incompatible:["Sharpness","Bane of Arthropods"]},{name:"Bane of Arthropods",id:"L",maxLevel:5,applicable:["Sword","Axe"],itemMultiplier:2,bookMultiplier:1,incompatible:["Smite","Sharpness"]},{name:"Knockback",id:"M",maxLevel:2,applicable:["Sword"],itemMultiplier:2,bookMultiplier:1,incompatible:[]},{name:"Fire Aspect",id:"N",maxLevel:2,applicable:["Sword"],itemMultiplier:4,bookMultiplier:2,incompatible:[]},{name:"Looting",id:"O",maxLevel:3,applicable:["Sword"],itemMultiplier:4,bookMultiplier:2,incompatible:[]},{name:"Efficiency",id:"P",maxLevel:5,applicable:["Pickaxe","Shovel","Axe","Hoe","Shears"],itemMultiplier:1,bookMultiplier:1,incompatible:[]},{name:"Silk Touch",id:"Q",maxLevel:1,applicable:["Pickaxe","Shovel","Axe","Hoe"],itemMultiplier:8,bookMultiplier:4,incompatible:["Fortune"]},{name:"Unbreaking",id:"R",maxLevel:3,applicable:["Sword","Pickaxe","Shovel","Axe","Hoe","Fishing Rod","Helmet","Chestplate","Leggings","Boots","Bow","Shears","Flint and Steel","Carrot on a Stick","Warped Fungus on a Stick","Shield","Elytra","Trident","Crossbow"],itemMultiplier:2,bookMultiplier:1,incompatible:[]},{name:"Fortune",id:"S",maxLevel:3,applicable:["Pickaxe","Shovel","Axe","Hoe"],itemMultiplier:4,bookMultiplier:2,incompatible:["Silk Touch"]},{name:"Power",id:"T",maxLevel:5,applicable:["Bow"],itemMultiplier:1,bookMultiplier:1,incompatible:[]},{name:"Punch",id:"U",maxLevel:2,applicable:["Bow"],itemMultiplier:4,bookMultiplier:2,incompatible:[]},{name:"Flame",id:"V",maxLevel:1,applicable:["Bow"],itemMultiplier:4,bookMultiplier:2,incompatible:[]},{name:"Infinity",id:"W",maxLevel:1,applicable:["Bow"],itemMultiplier:8,bookMultiplier:4,incompatible:["Mending"]},{name:"Luck of the Sea",id:"X",maxLevel:3,applicable:["Fishing Rod"],itemMultiplier:4,bookMultiplier:2,incompatible:[]},{name:"Lure",id:"Y",maxLevel:3,applicable:["Fishing Rod"],itemMultiplier:4,bookMultiplier:2,incompatible:[]},{name:"Frost Walker",id:"Z",maxLevel:2,applicable:["Boots"],itemMultiplier:4,bookMultiplier:2,incompatible:["Depth Strider"]},{name:"Mending",id:"a",maxLevel:1,applicable:["Sword","Pickaxe","Shovel","Axe","Hoe","Fishing Rod","Helmet","Chestplate","Leggings","Boots","Bow","Shears","Flint and Steel","Carrot on a Stick","Warped Fungus on a Stick","Shield","Elytra","Trident","Crossbow"],itemMultiplier:4,bookMultiplier:2,incompatible:["Infinity"]},{name:"Curse of Binding",id:"b",maxLevel:1,applicable:["Helmet","Chestplate","Leggings","Boots","Elytra","Carved Pumpkin","Head"],itemMultiplier:8,bookMultiplier:4,incompatible:[]},{name:"Curse of Vanishing",id:"c",maxLevel:1,applicable:["Sword","Pickaxe","Shovel","Axe","Hoe","Fishing Rod","Helmet","Chestplate","Leggings","Boots","Bow","Shears","Flint and Steel","Carrot on a Stick","Warped Fungus on a Stick","Shield","Elytra","Trident","Crossbow","Carved Pumpkin","Head","Compass","Recovery Compass"],itemMultiplier:8,bookMultiplier:4,incompatible:[]},{name:"Impaling",id:"d",maxLevel:5,applicable:["Trident"],itemMultiplier:4,bookMultiplier:2,incompatible:[]},{name:"Riptide",id:"e",maxLevel:3,applicable:["Trident"],itemMultiplier:4,bookMultiplier:2,incompatible:["Loyalty","Channeling"]},{name:"Loyalty",id:"f",maxLevel:3,applicable:["Trident"],itemMultiplier:1,bookMultiplier:1,incompatible:["Riptide"]},{name:"Channeling",id:"g",maxLevel:1,applicable:["Trident"],itemMultiplier:8,bookMultiplier:4,incompatible:["Riptide"]},{name:"Multishot",id:"h",maxLevel:1,applicable:["Crossbow"],itemMultiplier:4,bookMultiplier:2,incompatible:["Piercing"]},{name:"Piecing",id:"i",maxLevel:4,applicable:["Crossbow"],itemMultiplier:1,bookMultiplier:1,incompatible:["Multishot"]},{name:"Quick Charge",id:"j",maxLevel:3,applicable:["Crossbow"],itemMultiplier:2,bookMultiplier:1,incompatible:[]},{name:"Soul Speed",id:"k",maxLevel:3,applicable:["Boots"],itemMultiplier:8,bookMultiplier:4,incompatible:[]},{name:"Swift Sneak",id:"l",maxLevel:3,applicable:["Leggings"],itemMultiplier:8,bookMultiplier:4,incompatible:[]},{name:"Sweeping Edge",id:"m",maxLevel:3,applicable:["Sword"],itemMultiplier:4,bookMultiplier:2,incompatible:[]}],k={Helmet:"A",Chestplate:"B",Leggings:"C",Boots:"D",Sword:"E",Axe:"F",Pickaxe:"G",Shovel:"H",Hoe:"I",Shears:"J","Fishing Rod":"K",Bow:"L","Flint and Steel":"M","Carrot on a Stick":"N","Warped Fungus on a Stick":"O",Shield:"P",Elytra:"Q",Trident:"R",Crossbow:"S","Carved Pumpkin":"T",Head:"U",Compass:"V","Recovery Compass":"W",Book:"X"};class g{constructor(i){u(this,"enchantments",[]);u(this,"priorWorkPenalty",0);u(this,"item");this.item=i}toString(){return`${this.item}(${this.enchantments.join(", ")}) (${this.priorWorkPenalty})`}addEnchantment(i,e){this.enchantments.push({type:M.find(o=>o.name===i),level:e})}static unpack(i){const e=new g(Object.keys(k).find(l=>k[l]===i[0])),o=i.substring(1).match(/.{2}/g);return o&&(e.enchantments=o.map(l=>({type:M.find(n=>n.id===l[0]),level:+l[1]}))),e}pack(){return`${k[this.item]}${this.enchantments.reduce((i,e)=>i+e.type.id+e.level,"")}`}}const h=(t,i)=>{if(t.item!==i.item&&i.item!=="Book")throw new Error(`Cannot combine items ${t.item} and ${i.item}`);const e={target:t,sacrifice:i,result:new g(t.item),cost:t.priorWorkPenalty+i.priorWorkPenalty},o=t.pack()+i.pack(),l=S.get(o);if(l)return e.result.enchantments.push(...l.result.enchantments),e.result.priorWorkPenalty=Math.max(t.priorWorkPenalty,i.priorWorkPenalty)*2+1,e.cost=l.cost-l.target.priorWorkPenalty-l.sacrifice.priorWorkPenalty+e.target.priorWorkPenalty+e.sacrifice.priorWorkPenalty,e;e.result.enchantments.push(...t.enchantments),e.result.priorWorkPenalty=Math.max(t.priorWorkPenalty,i.priorWorkPenalty)*2+1;for(const n of i.enchantments){if(t.item!=="Book"&&n.type.applicable.indexOf(t.item)===-1)continue;let a=null,p=!0;for(const r of e.result.enchantments){if(n.type.incompatible.indexOf(r.type.name)>0){e.cost+=1,p=!1;break}if(r.type===n.type){a=r;break}}if(!p)break;a?a.level<n.level?a.level=n.level:a.level===n.level&&a.level<a.type.maxLevel&&a.level++:(a={type:n.type,level:n.level},e.result.enchantments.push(a)),e.cost+=(i.item==="Book"?a.type.bookMultiplier:a.type.itemMultiplier)*a.level}return S.set(o,e),e},S=new Map;function f(t){if(t.length===2){const e={steps:[],totalCost:0};let o,l,n;try{o=h(t[0],t[1])}catch(p){n=p}try{l=h(t[1],t[0])}catch(p){if(n)throw p}const a=o&&l?o.cost<l.cost?o:l:o||l;return e.steps.push(a),e.totalCost=a.cost,[e]}const i=[];for(let e=0;e<(t.length-1)/2;e++){const o=[];y(t,o,e+1);for(const l of o){const n=e===0?[{steps:[],totalCost:0}]:f(l[0]),a=f(l[1]);for(const p of n)for(const r of a){const m=e===0?l[0][0]:p.steps.at(-1).result,x=r.steps.at(-1).result;let s,c,v;try{s=h(m,x)}catch(d){v=d}try{c=h(x,m)}catch(d){if(v)throw d}const L=s&&c?s.cost<c.cost?s:c:s||c,b={steps:[],totalCost:0};b.steps.push(...p.steps,...r.steps),b.steps.push(L),b.totalCost+=p.totalCost+r.totalCost+L.cost,i.push(b)}}}return i}function w(t){let i=null;for(const e of t)(!i||e.totalCost<i.totalCost)&&(i=e);return i}function F(t){return M.find(i=>i.name===t)}function y(t,i,e,o=[],l=t.length){if(o.length===e){i.push([o,t]);return}for(let n=0;n<l;n++){const a=[...t],p=a.splice(n,1);p.push(...o);let r=i.length;if(y(a,i,e,p,n),o.length===t.length){const m=(r-i.length)/2;i.splice(-m,m)}}}export{g as I,f as a,w as b,M as e,F as g,k as i};
